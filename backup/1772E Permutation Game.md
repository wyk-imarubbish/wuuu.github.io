# 博弈问题解题报告

## 问题背景
本题是一个关于排列和玩家策略的博弈问题。两个玩家面对一个整数排列，目标是将其转换为升序或降序。玩家可以执行的操作包括：重新排列元素、改变元素的颜色、跳过回合。问题的核心在于预测在最优策略下哪个玩家将会获胜，或者是否会有平局。

## 问题陈述
给定一个整数排列，两个玩家轮流进行操作，目标是将排列转换为升序或降序。排列中的每个元素最初都是红色。玩家的操作包括：
1. 重新排列排列中的元素，但必须保持红色元素的位置不变。
2. 将一个红色元素的颜色改为蓝色。
3. 跳过当前回合。

如果排列最终变为升序，第一个玩家获胜；如果变为降序，第二个玩家获胜。如果游戏在极长的回合后仍未决出胜负，则为平局。

## 输入和输出格式
- **输入**：第一行是一个整数`T`，表示测试用例的数量。接下来是`T`组测试用例，每组测试用例的开始是两个整数`n`和`p`，其中`n`是排列的长度，`p`是长度为`n`的整数数组，表示排列。
- **输出**：对于每个测试用例，输出"First"如果第一个玩家获胜，"Second"如果第二个玩家获胜，或者"Tie"如果结果是平局。

## 算法逻辑
1. **初始化计数器**：定义三个计数器`fst`、`sec`和`both`，分别用于统计第一个玩家需要改变的元素数量、第二个玩家需要改变的元素数量以及两个玩家都需要改变的元素数量。
2. **遍历排列**：从1遍历到n，对于每个位置`i`：
   - 如果当前元素既不是升序位置`i`也不是降序位置`n-i+1`，则两个玩家都需要改变它，增加`both`计数。
   - 如果当前元素不是升序位置`i`但可以是降序位置`n-i+1`，则只有第一个玩家需要改变它，增加`fst`计数。
   - 如果当前元素不是降序位置`n-i+1`但可以是升序位置`i`，则只有第二个玩家需要改变它，增加`sec`计数。
3. **判断胜负**：根据`fst`、`sec`和`both`的值判断：
   - 如果`fst + both <= sec`，第一个玩家有足够的机会在第二个玩家之前完成排列的升序，因此第一个玩家获胜。
   - 如果`sec + both < fst`，第二个玩家有足够的机会在第一个玩家之前完成排列的降序，因此第二个玩家获胜。
   - 如果上述两个条件都不满足，游戏可能会持续很长时间而没有决出胜负，因此是平局。

## 代码实现

```cpp
#include <bits/stdc++.h>
#define MAXN 500010
#define inf 0x3f3f3f3f
#define rep(i, a, b) for(int i = (a); i <= (b); i++)
using namespace std;

int main() {
    ios::sync_with_stdio(false), cin.tie(nullptr);
    int T; cin >> T;
    while (T--) {
        int n; cin >> n;
        int fst = 0, sec = 0, both = 0;
        rep(i, 1, n) {
            int x; cin >> x;
            if (x != i && x != n - i + 1) {
                both++;
            } else if (x != i) {
                fst++;
            } else if (x != n - i + 1) {
                sec++;
            }
        }
        if (fst + both <= sec) {
            cout << "First" << endl;
        } else if (sec + both < fst) {
            cout << "Second" << endl;
        } else {
            cout << "Tie" << endl;
        }
    }
    return 0;
}
<!-- ##{"style":"<style>#postBody{font-size:20px}</style>"}## -->
<!-- ##{"script":"<script async src='//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js'></script>"}## -->